<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Test JSZip</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.11.0/jszip.min.js"></script>
</head>
<body>
<input type="file" id="imageInput" accept="image/*">
<button onclick="convertImage()">Convertir en ZIP</button>
<a id="downloadLink" style="display:none;">Télécharger ZIP</a>
<script>
function convertImage(){
    const file = document.getElementById('imageInput').files[0];
    if(!file) return alert("Choisissez une image.");

    const reader = new FileReader();
    reader.onload = async function(e){
        const base64Data = e.target.result.split(',')[1];
        const zip = new JSZip();
        zip.file("image.txt", base64Data);

        const content = await zip.generateAsync({type:"blob", compression:"DEFLATE"});
        if(content.size > 1024*1024){
            alert("Erreur : fichier compressé > 1 Mo");
            return;
        }

        const link = document.getElementById('downloadLink');
        link.href = URL.createObjectURL(content);
        link.download = "image.zip";
        link.style.display = "inline";
        link.textContent = "Télécharger ZIP";
    }
    reader.readAsDataURL(file);
}
</script>
</body>
</html>
